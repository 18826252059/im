{% extends 'TopxiaWebBundle::layout.html.twig' %}
{% set script_controller = 'friend-list/list' %}
{% block title %}{{'课程管理'|trans}} - {{ parent() }}{% endblock %}
{% block head_scripts %}
    <script
            src="https://code.jquery.com/jquery-1.12.4.js"
            integrity="sha256-Qw82+bXyGq6MydymqBxNPYTaUXXq7c8v3CwiYwLLNXU="
            crossorigin="anonymous"></script>
{% endblock %}

{% block content %}
<style>
    body {
        width: 100%;
        height:100%;
    }
.locked li a{
  padding:10px 15px 10px 0px !important;
}
.locked li a>span{
  display:inline-block;
  width:35px;
  padding:0px 10px;
}
</style>
  {#{{ render(controller('TopxiaWebBundle:Course:header', {course:course, manage: true})) }}#}

<div class="row" style="height: 100%;">
  <div class="col-md-3" style="height: 100%;">
    {% block side %}
      {% set side_nav = side_nav|default(null) %}
      <div class="sidenav locked" style="height: 80%;">
          {#<ul class="nav nav-pills nav-pills-sm mbs file-chooser-tabs">#}
          <ul class="nav nav-tabs nav-justified">
              <li><a class="file-chooser-uploader-tab" href="#video-chooser-upload-pane"
                     data-toggle="tab">{{ '历史消息'|trans }}</a></li>
              <li>
                  <a id="friend-list" href="#video-chooser-disk-pane" data-toggle="tab">
                      {{ '好友列表'|trans }}
                  </a>
              </li>

          </ul>
          <div id="friend-content" style="overflow: auto; height: 80%;">
          <ul class="nav nav-pills nav-pills-sm">
              <a href="#" class="list-group-item" style="border: 0px;">
              <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" style="border-radius: 50%;width: 34px;height: 34px;" />
              <span class="contact__name">Ethan Hawke</span>
              <span class="contact__status online"></span>
              </a>
          </ul>
          <ul class="nav nav-pills nav-pills-sm">
              <a href="#" class="list-group-item" style="border: 0px;">
              <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
              <span class="contact__name">Ethan Hawke</span>
              <span class="contact__status online"></span>
              </a>
          </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
              <ul class="nav nav-pills nav-pills-sm">
                  <a href="#" class="list-group-item" style="border: 0px;">
                      <img src="{{ asset('assets/img/avatar/1.png') }}" alt="" class="contact__photo" />
                      <span class="contact__name">Ethan Hawke</span>
                      <span class="contact__status online"></span>
                  </a>
              </ul>
          </div>
      </div>


    {% endblock %}
  </div>
  <div class="col-md-9" style="height: 100%;">
    {% block main %}{% endblock %}
  </div>
</div>
    <script>
        $("#friend-list").click(function () {

            $.ajax({
//                url: '/app_dev.php/mapi_v1/friend/list/'+userId,
                url: "{{ path('mapi_list_friend',{id:user.id}) }}",
                async: false,
                dataType: 'json',
                cache: false,
                success: function(response, status, jqXHR) {
//                    alert(response.data.friend.length);
                    var friends = response.data.friend;
                    var html = "";
                    $.each(friends,function (index,item) {
                        html += '<ul class=\"nav nav-pills nav-pills-sm\">' +
                                '<a href=\"#\" class=\"list-group-item\" style=\"border: 0px;\">';

                        if (item.smallAvatar == null || item.smallAvatar == "") {
                            html +=  '<img src=\"'+ "{{ asset('assets/img/default/avatar.png') }}" + '\" alt=\"\" class=\"contact__photo\" style=\"border-radius: 50%;width: 34px;height: 34px;margin:0 5px 0 0;\" />';
                        } else {
                            html +=  '<img src=\"'+ item.smallAvatar + '\" alt=\"\" class=\"contact__photo\" style=\"border-radius: 50%;width: 34px;height: 34px;margin:0 5px 0 0;\" />';
                        }

                        html += '<span class=\"contact__name\">' + item.nickname +'</span>' +
                                '<span class=\"contact__status online\"></span>' +
                                '</a></ul>';
                    });

                    $("#friend-content").html(html);
                },
                error: function(jqXHR, status, error) {
//                    Notify.danger(Translator.trans('请求上传授权码失败！'));
                }
            });
        });
    </script>
{% endblock %}